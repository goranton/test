<html lang="ru">
    <head>
        <title>test api</title>
    </head>
    <body>
        <div id="playground">

        </div>

        <script>
            const playground = document.getElementById('playground');

            const URLS = {
                CHARACTER: (id) => `https://rickandmortyapi.com/api/character/${id}`,
                CHARACTERS: () => 'https://rickandmortyapi.com/api/character',
                LOCATIONS: () => 'https://rickandmortyapi.com/api/location',
                EPISODES: () => 'https://rickandmortyapi.com/api/episode',
            };

            const apiWithPagination = (url) => {
                let current = url;

                let count, pages, nextUrl, prevUrl = undefined;

                const call = async () => {
                    const response = await fetch(url);

                    const {info, results} = await response.json();

                    count = info.count;
                    pages = info.pages;

                    nextUrl = info.next;
                    prevUrl = info.prev;

                    return results;
                };

                const next = () => {
                    if (nextUrl) {
                        current = nextUrl;
                        return call();
                    }
                };

                const prev = () => {
                    if (prevUrl) {
                        current = prevUrl;
                        return call();
                    }
                };

                return { count, pages, next, prev, call };
            };

            const generateCard = ({
                name, status,
                species, gender,
                image
            }) => {
                const nameEl = document.createElement('div');
                const statusEl = document.createElement('div');
                const speciesEl = document.createElement('div');
                const genderEl = document.createElement('div');
                const imageEl = document.createElement('img');

                nameEl.classList.add('name');
                statusEl.classList.add('status');
                speciesEl.classList.add('species');
                genderEl.classList.add('gender');
                imageEl.classList.add('image');

                nameEl.innerHTML = name;
                statusEl.innerHTML = status;
                speciesEl.innerHTML = species;
                genderEl.innerHTML = gender;
                imageEl.setAttribute('src', image);

                const wrapper = document.createElement('div');

                wrapper.classList.add('wrapper');

                wrapper.appendChild(nameEl);
                wrapper.appendChild(statusEl);
                wrapper.appendChild(speciesEl);
                wrapper.appendChild(genderEl);
                wrapper.appendChild(imageEl);

                return wrapper;
            };

            const api = apiWithPagination(URLS.CHARACTERS());

            const render = async () => {
                playground.innerHTML = '';

                const items = await api.call();

                items.forEach((item) => {
                    playground.appendChild(generateCard(item));
                })
            };

            render();
        </script>
    </body>
</html>
